<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<link rel="apple-touch-icon" sizes="76x76"
	href="assets/img/apple-icon.png">
<link rel="icon" type="image/png" sizes="96x96"
	href="assets/img/favicon.png">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

<title></title>

<meta
	content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0'
	name='viewport' />
<meta name="viewport" content="width=device-width" />


<!-- Bootstrap core CSS     -->
<link href="assets/css/bootstrap.min.css" rel="stylesheet" />

<!-- Animation library for notifications   -->
<link href="assets/css/animate.min.css" rel="stylesheet" />

<!--  Paper Dashboard core CSS    -->
<link href="assets/css/paper-dashboard.css" rel="stylesheet" />

<!--  CSS for Demo Purpose, don't include it in your project     -->
<link href="assets/css/demo.css" rel="stylesheet" />

<!--  Fonts and icons     -->
<link
	href="http://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css"
	rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Muli:400,300'
	rel='stylesheet' type='text/css'>
<link href="assets/css/themify-icons.css" rel="stylesheet">

</head>
<body>

	<div class="wrapper">
		<div class="sidebar" data-background-color="white"
			data-active-color="danger">

			<!--
    Tip 1: you can change the color of the sidebar's background using: data-background-color="white | black"
    Tip 2: you can change the color of the active button using the data-active-color="primary | info | success | warning | danger"
-->

			<div class="sidebar-wrapper">
				<div class="logo">
					<a href="doIndexUI.do" class="simple-text"> 哔哔论坛~~ </a>
				</div>

				<ul class="nav">
					<li class="active"><a href="doHot.do"> <i class="ti-panel"></i>
							<p>热门哔哔~~</p>
					</a></li>
					<li><a href="doUser.do"> <i class="ti-user"></i>
							<p>你的哔哔~~</p>
					</a></li>
					<li class="active"><a href="doPost.do"> <i
							class="ti-pencil-alt2"></i>
							<p>开始哔哔~~</p>
					</a></li>
					<li><a> <i class="ti-text"></i>
							<p>哔哔内容~~</p>
					</a></li>
					<!-- 回到首页~!!!整合时创建超链接-->
					<li><a href="#"> <i class="ti-map"></i>
							<p>回到首页~~</p>
					</a></li>
				</ul>
			</div>
		</div>

		<div class="main-panel">
			<nav class="navbar navbar-default">
				<div class="container-fluid">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle">
							<span class="sr-only">Toggle navigation</span> <span
								class="icon-bar bar1"></span> <span class="icon-bar bar2"></span>
							<span class="icon-bar bar3"></span>
						</button>
						<a class="navbar-brand" href="#">这里只是一群哔哔者的聚集地</a>
					</div>
				</div>
			</nav>


			<div class="content">
				<div class="container-fluid">
					<div class="row">
						<div class="col-md-12">
							<div class="card">
								<div class="header">
									<h4 class="title">哔哔内容</h4>
									<p class="category">这里有哔哔的具体内容</p>
								</div>
								<div class="content">

									<div class="BT-id">
										<p class="category">标题</p>
										<h3 id="tHead"></h3>
									</div>
									<div class="type-id">
										<p class="category">类别</p>
										<h4 id="tType"></h4>
									</div>
									<div class="user-id">
										<p class="category">作者</p>
										<h5 id="tUser"></h5>
									</div>
									<div class="date-id">
										<p class="category">日期</p>
										<h6 id="tCreatedTime"></h6>
									</div>

									<div class="message-id">
										<!--
                                     there are also "text-info", "text-success", "text-warning", "text-danger" clases for the text
                                     -->
										<p class="category">正文</p>
										<p id="tMessage" class="text-primary">正文内容</p>
									</div>
									<div>
										<h1>-----------------------------------------------</h1>
									</div>
									<div class="reply-id">
										<!--
                                     there are also "text-info", "text-success", "text-warning", "text-danger" clases for the text
                                     -->
										<p class="category">评论区</p>

										<table class="table table-striped">
											<thead>
												<th>id</th>
												<th>头像</th>
												<th>回复内容</th>
												<th>回复时间</th>
												<th>回复人</th>
											</thead>
											<tbody id="tbodyId">
											</tbody>
										</table>

									</div>
									<div>
										<h1>-----------------------------------------------</h1>
									</div>
									<label for="replyContent" class="col-sm-2 control-label">评论</label>
									<div class="col-sm-10">
										<textarea id="replyContent"
											style="border: 0; border-radius: 5px; background-color: rgba(241, 241, 241, .98); width: 790px; height: 200px; padding: 10px; resize: none;"
											placeholder="把你要哔哔的写在这里吧~~"></textarea>
									</div>
									<div class="box-footer">
										<button type="button" class="btn btn-info pull-right btn-save">BiBi~~</button>
									</div>
									<div class="box-footer">
										<button type="button" class="btn btn-info pull-right"
											onclick="window.location.href='doUser.do'">返回你的哔哔~~</button>
									</div>
									<div>
										<h1>-----------------------------------</h1>
									</div>
								</div>
							</div>
						</div>

					</div>
				</div>
			</div>




		</div>
	</div>
</body>

<!--   Core JS Files   -->
<script src="assets/js/jquery-1.10.2.js" type="text/javascript"></script>
<script src="assets/js/bootstrap.min.js" type="text/javascript"></script>

<!--  Checkbox, Radio & Switch Plugins -->
<script src="assets/js/bootstrap-checkbox-radio.js"></script>

<!--  Charts Plugin -->
<script src="assets/js/chartist.min.js"></script>

<!--  Notifications Plugin    -->
<script src="assets/js/bootstrap-notify.js"></script>

<!--  Google Maps Plugin    -->
<!---<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js"></script>--->

<!-- Paper Dashboard Core javascript and methods for Demo purpose -->
<script src="assets/js/paper-dashboard.js"></script>

<!-- Paper Dashboard DEMO methods, don't include it in your project! -->
<script src="assets/js/demo.js"></script>
<script type="text/javascript">
	$(function() {
		var id = oneValue();
		console.log(id);
		doGetForum(id);//获取帖子信息
		doGetReply(id);//获取该帖子的评论信息
		$(".box-footer").on("click", ".btn-save", doSave)
	});
	function oneValue() {
		var url = window.location.search;
		var result = url.substr(url.indexOf("=") + 1);
		return result;
	}
	function doGetForum(id) {
		var url = "doFindByForumID.do";
		var params = {
			"pageCurrent":1,
			"forumID" : id
		};
		$.getJSON(url, params, function(result) {
			console.log(result);
			//将服务端返回的数据填充到指定的地方中
			setToPage(result);
		});
	}
	function doGetReply(id) {
		var url = "doFindReplyById.do";
		var params = {
			"replyportID" : id
		};
		console.log(id);
		$.getJSON(url, params, function(result) {
			console.log(result);
			//将服务端返回的数据填充到指定的地方中
			setReplyToPage(result);
		})
	}
	function setReplyToPage(result) {
		var tBody = $("#tbodyId");
		tBody.empty();
		for ( var i in result) {//循环一次取一行记录
			//构建tr对象
			var tr = $("<tr></tr>");
			//构建td对象
			var tds = "<td>" + result[i].replyID + "</td>" + "<td>"
					+ result[i].replyAvatar + "</td>" + "<td>"
					+ result[i].replyContent + "</td>" + "<td>"
					+ result[i].replyTime + "</td>" + "<td>"
					+ result[i].replyName + "</td>";
			//将td追加到tr中
			tr.append(tds);
			//将tr追加到tbody中
			tBody.append(tr);
		}
	}
	function setToPage(result) {
		var thead = $("#tHead");
		var tType = $("#tType");
		var tUser = $("#tUser");
		var tCreatedTime = $("#tCreatedTime");
		var tMessage = $("#tMessage");
		thead.empty();
		tType.empty();
		tUser.empty();
		tCreatedTime.empty();
		tMessage.empty();
		var forumbt = result.forumBT;
		var forumtype = result.forumType;
		var createduser = result.createdUser;
		var createdtime = result.createdTime;
		var forummessage = result.forumMessage;
		thead.append(forumbt);
		tType.append(forumtype);
		tUser.append(createduser);
		tCreatedTime.append(createdtime);
		tMessage.append(forummessage);
	}
	function doSave() {
		//1.获取表单数据
		var url = "doPostReply.do"
		var params = getFormData();
		//2.把数据异步提交到服务端
		$.post(url, params, function(result) {
			console.log(result);//
			alert(result);
			//doHotList();
		});
		function getFormData() {
			var replyid = oneValue();
			console.log(replyid);
			var params = {
				replyContent : $("#replyContent").val(),
				replyportID : replyid
			};
			return params;
		}
	}
</script>
</html>
